# REGRAS DO PROJETO â€” Sistema de AnÃ¡lise de Processos RequisitÃ³rios

## CONTEXTO
Este Ã© um sistema de anÃ¡lise automatizada de processos requisitÃ³rios de 
licitaÃ§Ã£o do ExÃ©rcito Brasileiro, usado pela SAL/CAF do Cmdo 9Âº Gpt Log 
(Campo Grande/MS). O sistema extrai dados de PDFs compilados, valida 
conforme Lei 14.133/2021, e gera mÃ¡scaras de NE + rascunhos de despacho.

## STACK
- Python 3.11+
- Streamlit (interface)
- pdfplumber (extraÃ§Ã£o de texto de PDF)
- Tesseract/pytesseract (OCR para NCs em imagem)
- SQLite (banco local)
- Regex (extraÃ§Ã£o de padrÃµes)

## ESTRUTURA DO PROJETO
```
projeto_limpo/
â”œâ”€â”€ app.py                      # App principal Streamlit
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ components.py           # Componentes de UI reutilizÃ¡veis
â”‚   â”œâ”€â”€ mock_data.py            # Dados mock (serÃ¡ substituÃ­do)
â”‚   â”œâ”€â”€ database.py             # Schema e operaÃ§Ãµes SQLite
â”‚   â”œâ”€â”€ extractor.py            # [A CRIAR] ExtraÃ§Ã£o de dados do PDF
â”‚   â”œâ”€â”€ validator.py            # [A CRIAR] ValidaÃ§Ãµes e regras de negÃ³cio
â”‚   â”œâ”€â”€ ne_generator.py         # [A CRIAR] Gerador de mÃ¡scara da NE
â”‚   â””â”€â”€ despacho_generator.py   # [A CRIAR] Gerador de texto de despacho
â”œâ”€â”€ docs/                       # DocumentaÃ§Ã£o de referÃªncia
â”‚   â”œâ”€â”€ MAPEAMENTO_PADROES_PROCESSOS_v2.md
â”‚   â”œâ”€â”€ ESPECIFICACAO_LOGICA_NEGOCIO_v2.md
â”‚   â””â”€â”€ PROMPT_BOLT_INTERFACE.md
â”œâ”€â”€ tests/                      # PDFs de teste
â”‚   â”œâ”€â”€ Processo65345_000389_202685.pdf
â”‚   â”œâ”€â”€ Processo64136_000430_202616.pdf
â”‚   â””â”€â”€ Processo65297_001232_202690.pdf
â”œâ”€â”€ data/                       # Banco SQLite (gitignored)
â”œâ”€â”€ assets/styles.css           # CSS customizado
â””â”€â”€ requirements.txt
```

## DOCUMENTAÃ‡ÃƒO OBRIGATÃ“RIA
Antes de implementar qualquer mÃ³dulo, LEIA os arquivos em docs/:
- `MAPEAMENTO_PADROES_PROCESSOS_v2.md` â€” contÃ©m TODOS os padrÃµes regex, 
  formatos de data, estrutura das NCs, exemplos reais
- `ESPECIFICACAO_LOGICA_NEGOCIO_v2.md` â€” contÃ©m o fluxo completo do 
  analista, regras de severidade, templates de mÃ¡scara e despacho

## REGRAS DE DESENVOLVIMENTO

### Linguagem
- Todo cÃ³digo, comentÃ¡rios e docstrings em PORTUGUÃŠS BRASILEIRO
- Usar terminologia militar quando apropriado (OM, NE, NC, UASG, OD, etc.)
- Interface 100% em portuguÃªs

### PrincÃ­pio fundamental
O sistema Ã© ferramenta de APOIO ao analista. Ele NUNCA reprova automaticamente.
- DivergÃªncias na tabela de itens (cÃ¡lculo, ND, SI) â†’ âš ï¸ AMARELO (sinalizar)
- Prazo de NC vencido â†’ âš ï¸ AMARELO (sinalizar, nÃ£o bloquear)
- CertidÃ£o vencida â†’ ğŸ”´ VERMELHO (sinalizar como provÃ¡vel reprovaÃ§Ã£o)
- CNPJ divergente â†’ ğŸ”´ VERMELHO (sinalizar como provÃ¡vel reprovaÃ§Ã£o)
- A decisÃ£o final Ã© SEMPRE do analista humano

### Severidades (3 nÃ­veis)
- ğŸŸ¢ VERDE â€” conforme, nenhuma aÃ§Ã£o
- âš ï¸ AMARELO â€” sinalizaÃ§Ã£o, analista decide
- ğŸ”´ VERMELHO â€” bloqueio provÃ¡vel, analista investiga

### PadrÃµes de cÃ³digo
- FunÃ§Ãµes pequenas e focadas (max ~50 linhas)
- Docstrings em todas as funÃ§Ãµes pÃºblicas
- Type hints quando possÃ­vel
- Tratamento de erro robusto (PDFs sÃ£o imprevisÃ­veis)
- Logs com print() por enquanto (logging virÃ¡ depois)

### ExtraÃ§Ã£o de PDF
- Usar pdfplumber como primeira opÃ§Ã£o
- Se pÃ¡gina nÃ£o tem texto extraÃ­vel â†’ fallback para Tesseract OCR
- Regex deve ser testado contra os 3 processos em tests/
- Formatos de data aceitos: DD/MM/YYYY, DDMMMYY, DD MMM YY, DD/MMM/YYYY
- Formatos de NC: 2026NC000xxx, 2026NC400xxx

### Banco de dados
- SQLite local, arquivo em data/analise_processos.db
- UASGs novas encontradas em processos â†’ salvar automaticamente
- Tabela nd_subelementos â†’ prÃ©-carregar da planilha Excel

### Interface Streamlit
- JÃ¡ estÃ¡ funcional com dados mock
- PrÃ³ximo passo: substituir chamadas a mock_data por dados reais
- Manter os 4 estÃ¡gios: IdentificaÃ§Ã£o, RequisiÃ§Ã£o, NC/CertidÃµes, DecisÃ£o
- BotÃ£o "AnÃ¡lise sem NC?" deve pular validaÃ§Ãµes da NC

### MÃ¡scara da NE
- Templates variam por tipo (licitaÃ§Ã£o, contrato, dispensa)
- SÃ³ incluir campos que existem na NC (se nÃ£o tem PTRES, nÃ£o incluir)
- Formato real varia â€” seguir exemplos do NOVO_MODELO_CAMPO_DESCRICAO_NE.docx
- Siglas de OM em MAIÃšSCULAS e abreviadas

### Despacho
- SÃ³ gerar para ressalva e reprovaÃ§Ã£o (aprovaÃ§Ã£o = encaminhamento, sem despacho)
- Sempre comeÃ§a com "Informo que..."
- Sem cabeÃ§alho, sem assinatura â€” sÃ³ o corpo do texto
- Caixa de texto editÃ¡vel na interface

## UASGs MAIS USADAS
- 160136 â€” 9Âº Gpt Log
- 160141 â€” CRO/9
- 160142 â€” 9Âº B Sup
- 160143 â€” H Mil A CG
- 160078 â€” CMCG
